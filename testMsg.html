<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
		<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
		<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/json3.js"></script>
	</head>

	<body>
		<h3>Please postMessage to me</h3><br>
		<p id='textBoard'>First Line.</p><br>
		<input id='targetUrl' type='text' size='100px'><button id='loadUrl' class='btn btn-primary' value='load url'>Load URL</button><br>
		<iframe id='pageFrame' width='800pt' height='600pt'></iframe>
		<script>

			if(console && console.log) {
 				// ...
			} else {
				var console = {log: function() {}
				};
			}

			var myframe = document.getElementById('pageFrame');
			var text = document.getElementById('textBoard');
			var urlAddress = document.getElementById('targetUrl');
			$("#loadUrl").click(function() {
				console.log("ready to load url: " + urlAddress.value);
				myframe.src = urlAddress.value;
			});

			function messageReceiver(event) {
				console.log("getMessage: ");
				console.log(event);
				console.log("typeof event.data: " + (typeof event.data))
				if((typeof event.data) === "string") {
					console.log("typeof event.data: " + event.data)
					text.innerHTML = text.innerHTML + "<br> typeof event.data is " + typeof event.data + "; " + (new Date()) + ", orogin=" + event.origin.toString() + " --> " + (event.data);
				} else {
					console.log("typeof event.data: " + event.data)
					text.innerHTML = text.innerHTML + "<br> typeof event.data is " + typeof event.data + "; " + (new Date()) + ", orogin=" + event.origin.toString() + " --> " + JSON.stringify(event.data);
				}
			}

			$('document').ready(function() {
				if(window.addEventListener) {
					window.addEventListener("message", messageReceiver);
				} else {
					window.attachEvent("onmessage", messageReceiver);
				}

				$("#targetUrl").keyup(function(event){
			    	if(event.keyCode == 13){
			        	myframe.src = urlAddress.value;
			    	}
				});
			});

		</script>
	</body>
</html>